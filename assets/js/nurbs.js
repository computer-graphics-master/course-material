define(['js/sylvester'],function(a){'use strict';const b={Nurbs(a,b){this.points=a,this.knots=b},evaluate(b){const c=this.knots.length-this.points.length;let d=a.$V([0,0]),e=0;for(let a=0;a<this.points.length;++a){const f=this.basisFunc(a,c,b)*this.points[a].weight,g=this.points[a].multiply(f);e+=f,d=d.add(g)}return d.multiply(1/e)},basisFunc(a,b,c){return 1==b?this.degreeOneBasis(a,c):this.degreeKBasis(a,b,c)},degreeOneBasis(a,b){return this.knots[a]<=b&&this.knots[a+1]>b&&this.knots[a]<this.knots[a+1]?1:0},degreeKBasis(a,b,c){const d=this.calculateCoefficients(a,b,c),e=[this.basisFunc(a,b-1,c),this.basisFunc(a+1,b-1,c)];return d[0]*e[0]+d[1]*e[1]},calculateCoefficients(a,b,c){var d=Math.abs;const e=c-this.knots[a],f=this.knots[a+b]-c,g=this.knots[a+b-1]-this.knots[a],h=this.knots[a+b]-this.knots[a+1];return[1e-10>d(g)?0:e/g,1e-10>d(h)?0:f/h]}};return b});